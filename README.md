## 📁 프로젝트 구조

### 1) `baseline/` — RAG 베이스라인 코드 모음
기존에 사용하던 RAG 파이프라인 코드를 한곳에 모아둔 “기준(베이스라인)” 구현입니다.  
각 파일은 파이프라인 단계 순서대로 번호를 붙여 정리했습니다.

- `1. text_parsing.py` : 문서 텍스트 추출/정리(파싱)
- `2. build_vector_db.py` : 문서 임베딩 & 벡터 DB(예: FAISS) 구축
- `3. retriever_hy+rerank.py` : 하이브리드 검색 + 리랭크 조합 실험
- `3+. retriever_mmr.py` : MMR 기반 검색(다양성 반영) 실험
- `4. context_builder.py` : 검색된 문서 조각을 컨텍스트로 구성
- `5. generate_answer.py` : LLM 답변 생성 단계
- `hwp_parsing.ipynb` : HWP 파싱/추출 실험 노트북

---

### 2) `hwp_to_pdf_to_md/` — HWP → PDF → MD 변환 파이프라인
HWP 문서를 **PDF로 변환한 뒤**, PDF를 **Markdown(MD)로 변환**하는 흐름입니다.

**MD를 쓰는 이유:**  
- VLM(Vision-Language Model)을 활용하여  
  **표(table) 구조를 최대한 유지한 상태로 문서를 정리**
- 이후 표 추출/교체, RAG 검색 성능 개선에 유리

### 🔄 PDF → MD 변환 시 처리 방식

- PDF를 **페이지 단위로 분리**하여 텍스트 추출
- 각 페이지 시작 지점에 다음과 같은 ** 페이지 식별 주석 삽입 **
<!-- page: N -->

## 페이지 번호 처리 방식

페이지 번호는 **원본 PDF의 실제 페이지 번호와 1:1로 대응**됩니다.

---

## 페이지 주석 사용 목적

이 페이지 주석은 이후 단계에서 다음 목적을 위해 사용됩니다.

- **VLM 기반 표 추출 시 삽입 위치 기준**
- **페이지별 표 / 텍스트 매핑**
- **재실행 시 표 블록 교체 및 중복 방지**

---

## 구성 파일

1. **hwp_to_pdf.py**  
   HWP → PDF 변환

2. **pdf_to_md.py**  
   PDF → MD 변환  
   (페이지 단위 분리 + `<!-- page: N -->` 주석 삽입)

3. **pdf_to_md_test.ipynb**  
   PDF 단일 파일 대상으로 변환 테스트 / 검증



---

### 3) `extract_tables_to_md.py` — (전체 문서 대상) 표 추출/MD 변환 작업
단일 테스트가 아니라, **여러 문서(전체 파일)** 를 대상으로  
VLM을 이용해 **표를 추출하고 Markdown으로 반영**하는 “실제 처리용” 스크립트입니다.

## 🎯 주요 목적

- **PDF 텍스트 추출만으로는 손실되기 쉬운 표 구조(열/행/캡션 정보)를 최대한 보존**
- **사업비, 일정, 조건 등 정형 정보에 대한 RAG 검색 성능 향상**

---

## 🔄 처리 흐름

1. PDF 페이지를 **이미지(JPEG)** 로 렌더링  
2. **VLM(Vision-Language Model)** 을 사용해 페이지 내 **표(table)만 추출**  
3. 추출 결과를 **Markdown table 형식**으로 변환  
4. 기존 MD 문서의 `<!-- page: N -->` 기준 위치에  
   - 표 블록을 **중복 없이 삽입**
   - 재실행 시 **기존 표를 교체하는 방식**으로 반영

---

## ✨ 특징

- **PNG 대신 JPEG 사용** → API 부하 및 파일 용량 감소  
- **DPI 기반 렌더링** → 표 인식 품질 안정화  
- **비동기 병렬 처리(concurrency 제한)** 적용  
- **JSON 파싱 오류 대비 안전 파싱 로직** 포함  

---

## 📂 `final_docs/` — RAG 입력용 최종 Markdown 문서

위 전처리 및 표 추출 과정을 거쳐 생성된  
**RAG 실험에 실제로 사용되는 최종 Markdown 문서 모음**입니다.

- PDF 원문을 **페이지 단위로 텍스트화**
- **VLM으로 추출한 표**가 페이지별로 반영됨
- **팀원 간 공통 기준 문서셋**으로 사용

`final_docs/`에 포함된 MD 파일들은 이후  
**임베딩 → 검색 → 답변 생성** 등  
RAG 파이프라인의 **입력 데이터**로 활용됩니다.
